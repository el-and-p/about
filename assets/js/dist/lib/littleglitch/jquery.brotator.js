!function(e){e.fn.brotator=function(t){var n={animation:"fade",animationSpeed:500,easing:"linear",autorotate:!0,timeout:8e3,content:".content",item:".item",menu:".media-index",menuItem:".media-index-item",menuUpdate:"default",next:".next",previous:".previous",hasMenu:!1,menuClick:!0,hasButtons:!0,contentSetup:null,wait:!0,lazyloader:!1,zIndex:2,complete:null,namespace:null};return this.each(function(){t&&e.extend(n,t);var i=n.namespace+Math.floor(10001*Math.random())||"/"+this.id,r=e(this),o=r.find(n.content),s=o.find(n.item).size();if("destroy"===t){var a=r.data("brotator"),u=r.data("brotator_timer"),c=r.data("brotator_menu"),l=r.data("brotator_buttons"),f=r.data("brotator_content"),d=r.data("namespace");return u&&u.clearAutoTimer.apply(a[0],Array.prototype.splice.call(arguments,1)),c&&c.clearEvents(),l&&l.clearEvents(),f.reset(),e.unsubscribe(d+"/transition/start"),e.unsubscribe(d+"/transition/end"),e.unsubscribe(d+"/lazyloader/get"),e.unsubscribe(d+"/state/updated"),r.data("brotator",""),r.data("brotator_timer",""),r.data("brotator_menu",""),r.data("brotator_buttons",""),r.data("brotator_content",""),r.data("namespace",""),void 0}var p={timeoutID:null,initTriggers:function(){r.on("start.timer.brotator",function(){n.autorotate=!0,p.init.call(p)}),r.on("stop.timer.brotator",function(){n.autorotate=!1,p.clearAutoTimer.call(p)})},clearTriggers:function(){r.off("start.timer.brotator"),r.off("stop.timer.brotator")},init:function(){this.setAutoRotate(),e.subscribe(i+"/transition/start",function(e,t){t&&p.clearAutoTimer()}),e.subscribe(i+"/transition/end",function(){n.autorotate&&p.setAutoRotate()})},setAutoRotate:function(){var t=n.timeout;n.wait||(t=50,n.wait=!0),p.timeoutID=setTimeout(function(){e.publish(i+"/transition/start",[h.next])},t),r.data("timer",p.timeoutID)},clearAutoTimer:function(){var e=r.data("timer");e&&(clearTimeout(e),n.autorotate=!1)}},h={current:0,next:1,previous:s-1,inTransition:!1,updateState:function(t){this.updateProp("current",t);var n=s-1>t?t+1:0,r=0===t?s-1:t-1;this.updateProp("next",n),this.updateProp("previous",r),this.updateProp("inTransition",!1),e.publish(i+"/state/updated",[{next:n,current:h.current}])},updateProp:function(e,t){this[e]=t},init:function(){e.subscribe(i+"/transition/start",function(){h.updateProp("inTransition",!0)}),e.subscribe(i+"/transition/end",function(e){h.updateState(e)})}},m={elem:e(n.menu),init:function(){e.subscribe(i+"/transition/start",function(e){m.updateMenu[n.menuUpdate](e)}),n.menuClick&&this.clickEvent()},clearEvents:function(){m.elem.off("click",n.menuItem)},clickEvent:function(){var t=m.elem;t.on("click",n.menuItem,function(n){if(n.preventDefault(),-1===this.className.indexOf("is-selected")&&!h.inTransition){var r=t.find("li").index(e(this).closest("li"));e.publish(i+"/transition/start",[r,!0])}})},updateMenu:{"default":function(e){var t=m.elem.find(".is-selected"),n=m.elem.find("li").eq(e);t.removeClass("is-selected "),n.find("a").addClass("is-selected ")}}},g={init:function(){this.clickEvent()},nextButton:r.find(n.next),previousButton:r.find(n.previous),clearEvents:function(){e.each([this.nextButton,this.previousButton],function(){e(this).off("click")})},clickEvent:function(){e.each([this.nextButton,this.previousButton],function(){e(this).click(function(t){if(t.preventDefault(),!h.inTransition){var n=-1!==this.className.indexOf("next")?h.next:h.previous;e.publish(i+"/transition/start",[n,!0])}})})}},v={imgCache:{},init:function(){this.initCache(),this.initSubscriptions()},initCache:function(){o.find(n.item).each(function(){var t=e(this);if(t.find("img[data-original]").length){var n=t.find("img").attr("data-original");n&&(v.imgCache[n]=t.find("img")[0])}})},initSubscriptions:function(){e.subscribe(i+"/lazyloader/get",function(e){var t=o.find("li").eq(e.next);t.find("img[data-original]").length&&!v.isImageLoaded(t)&&v.processImg(t)}),e.subscribe(i+"/state/updated",function(e){var t=o.find("li").eq(e.next);t.find("img[data-original]").length&&!v.isImageLoaded(t)&&v.processImg(t)})},processImg:function(e){var t=e.find("img"),n=t.attr("data-original");t[0].src=n},isImageLoaded:function(e){var t=e.find("img");return-1!==t[0].src.indexOf(t.attr("data-original"))},checkCache:function(e){return v.imgCache[e]},getImg:function(e){var t;return v.checkCache(e)?t=v.imgCache[e]:(t=new Image,t.src=e,t.className="rotator-header-image",v.imgCache[e]=t),t},insertImg:function(e,t){e.prepend(t)}},y={count:o.find("li").length,reset:function(){var t=o.find("li").first();o.attr("style",""),o.find("li").each(function(){e(this).attr("style","")}),t.is(".is-selected")||(o.find(".is-selected").removeClass("is-selected"),o.find("li").first().addClass("is-selected"))},init:function(){n.contentSetup&&y.contentSetup[n.contentSetup](),e.subscribe(i+"/transition/start",function(t){r.trigger("brotator.transition.start",{next:t}),n.lazyloader&&e.publish(i+"/lazyloader/get",[{next:t}]),y.animations[n.animation](t)})},postTransition:function(e,t){e.removeClass("is-selected"),t.addClass("is-selected"),n.complete&&n.complete.call(t[0])},contentSetup:{responsive:function(){o.css({width:100*y.count+"%"}),o.find("li").each(function(){e(this).css({width:100/y.count+"%",display:"block"})})}},animations:{fade:function(t){var r=o.find(n.item),s=r.eq(h.current),a=r.eq(t);Modernizr.csstransitions&&Modernizr.csstransforms?(s.removeClass("is-fading-in").addClass("is-fading-out"),setTimeout(function(){a.removeClass("is-fading-out").addClass("is-fading-in")},150),setTimeout(function(){y.postTransition(s,a),e.publish(i+"/transition/end",[t])},1e3)):(s.css({"z-index":1}).animate({opacity:"0"},n.animationSpeed,n.easing),a.css({display:"block",opacity:"0","z-index":n.zIndex}).animate({opacity:"1"},n.animationSpeed,n.easing,function(){s.attr("style",""),y.postTransition(s,a),e.publish(i+"/transition/end",[t])}))},slide:function(t){var r=o.find(n.item),s=r.eq(h.current),a=r.eq(t),u=100*t;Modernizr.csstransitions?(o.css({left:-1*u+"%"}),y.postTransition(s,a),setTimeout(function(){e.publish(i+"/transition/end",[t])},500)):o.animate({left:-1*u+"%"},n.animationSpeed,n.easing,function(){y.postTransition(s,a),e.publish(i+"/transition/end",[t])})}}};return"stopAutoRotate"===t?p.clearAutoTimer.apply(this,Array.prototype.splice.call(arguments,1)):"startAutoRotate"===t?p.setAutoRotate.apply(this,Array.prototype.splice.call(arguments,1)):("string"!=typeof t&&(n.hasMenu&&m.init(),n.hasButtons&&g.init(),n.autorotate&&p.init(),p.initTriggers(),n.lazyloader&&v.init(),h.init(),y.init()),r.data("brotator")||(r.data("brotator",e(this)),r.data("brotator_timer",p),r.data("brotator_menu",m),r.data("brotator_buttons",g),r.data("brotator_content",y),r.data("namespace",i)),void 0)})}}(jQuery);
//# sourceMappingURL=jquery.brotator.js.map